diff -Npruw stock-framework/smali/android/app/Instrumentation.smali pdroid-framework/smali/android/app/Instrumentation.smali
--- stock-framework/smali/android/app/Instrumentation.smali	2013-07-15 18:10:54.982628028 -0500
+++ pdroid-framework/smali/android/app/Instrumentation.smali	2013-07-15 18:10:48.458628199 -0500
@@ -6,7 +6,6 @@
 # annotations
 .annotation system Ldalvik/annotation/MemberClasses;
     value = {
-        Landroid/app/Instrumentation$1;,
         Landroid/app/Instrumentation$Idler;,
         Landroid/app/Instrumentation$ActivityGoing;,
         Landroid/app/Instrumentation$ActivityWaiter;,
@@ -53,6 +52,8 @@
 
 .field private mPerformanceCollector:Landroid/os/PerformanceCollector;
 
+.field private mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
 .field private mRunner:Ljava/lang/Thread;
 
 .field private final mSync:Ljava/lang/Object;
@@ -865,170 +866,131 @@
 .end method
 
 .method public execStartActivities(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;[Landroid/content/Intent;Landroid/os/Bundle;)V
-    .registers 17
-
-    move-object v1, p2
-
-    check-cast v1, Landroid/app/IApplicationThread;
-
-    iget-object v0, p0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
-
-    if-eqz v0, :cond_37
-
-    iget-object v2, p0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
-
-    monitor-enter v2
+    .registers 30
 
-    :try_start_a
-    iget-object v0, p0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
-
-    invoke-interface {v0}, Ljava/util/List;->size()I
+    move-object/from16 v3, p2
 
-    move-result v6
+    check-cast v3, Landroid/app/IApplicationThread;
 
-    const/4 v8, 0x0
+    const-string v2, "Instrumentation"
 
-    :goto_11
-    if-ge v8, v6, :cond_36
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    iget-object v0, p0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-interface {v0, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    const-string v6, "PDroid:Instrumentation:execStartActivities: execStartActivities for "
 
-    move-result-object v7
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    check-cast v7, Landroid/app/Instrumentation$ActivityMonitor;
+    move-result-object v4
 
-    const/4 v0, 0x0
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    const/4 v4, 0x0
+    move-result-object v6
 
-    aget-object v4, p5, v4
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v7, p1, v0, v4}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+    move-result-object v4
 
-    move-result v0
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    if-eqz v0, :cond_33
+    move-result-object v4
 
-    iget v0, v7, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    add-int/lit8 v0, v0, 0x1
+    if-eqz p5, :cond_6f
 
-    iput v0, v7, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    const/4 v12, 0x0
 
-    invoke-virtual {v7}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+    move-object/from16 v11, p5
 
-    move-result v0
+    array-length v0, v11
 
-    if-eqz v0, :cond_36
+    move/from16 v18, v0
 
-    monitor-exit v2
+    const/16 v16, 0x0
 
-    :goto_32
-    return-void
+    :goto_2a
+    move/from16 v0, v16
 
-    :cond_33
-    add-int/lit8 v8, v8, 0x1
+    move/from16 v1, v18
 
-    goto :goto_11
+    if-ge v0, v1, :cond_51
 
-    :cond_36
-    monitor-exit v2
-    :try_end_37
-    .catchall {:try_start_a .. :try_end_37} :catchall_53
+    aget-object v17, v11, v16
 
-    :cond_37
-    :try_start_37
-    array-length v0, p5
+    :try_start_32
+    invoke-virtual/range {v17 .. v17}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    new-array v3, v0, [Ljava/lang/String;
+    move-result-object v2
 
-    const/4 v8, 0x0
+    if-eqz v2, :cond_c7
 
-    :goto_3b
-    array-length v0, p5
+    invoke-virtual/range {v17 .. v17}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    if-ge v8, v0, :cond_56
+    move-result-object v2
 
-    aget-object v0, p5, v8
+    const-string v4, "android.intent.action.CALL"
 
-    const/4 v2, 0x0
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+    move-result v2
 
-    aget-object v0, p5, v8
+    if-nez v2, :cond_50
 
-    invoke-virtual {p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual/range {v17 .. v17}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
     move-result-object v2
 
-    invoke-virtual {v0, v2}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+    const-string v4, "android.intent.action.DIAL"
 
-    move-result-object v0
-
-    aput-object v0, v3, v8
-    :try_end_50
-    .catch Landroid/os/RemoteException; {:try_start_37 .. :try_end_50} :catch_69
-
-    add-int/lit8 v8, v8, 0x1
-
-    goto :goto_3b
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    :try_end_4d
+    .catch Ljava/lang/Exception; {:try_start_32 .. :try_end_4d} :catch_a9
 
-    :catchall_53
-    move-exception v0
-
-    :try_start_54
-    monitor-exit v2
-    :try_end_55
-    .catchall {:try_start_54 .. :try_end_55} :catchall_53
-
-    throw v0
+    move-result v2
 
-    :cond_56
-    :try_start_56
-    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+    if-eqz v2, :cond_c7
 
-    move-result-object v0
+    :cond_50
+    const/4 v12, 0x1
 
-    move-object v2, p5
+    :cond_51
+    if-nez v12, :cond_cb
 
-    move-object v4, p3
+    const-string v2, "Instrumentation"
 
-    move-object/from16 v5, p6
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    invoke-interface/range {v0 .. v5}, Landroid/app/IActivityManager;->startActivities(Landroid/app/IApplicationThread;[Landroid/content/Intent;[Ljava/lang/String;Landroid/os/IBinder;Landroid/os/Bundle;)I
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    move-result v9
+    const-string v6, "PDroid:Instrumentation:execStartActivities: No provided intents triggered checking for "
 
-    const/4 v0, 0x0
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    aget-object v0, p5, v0
+    move-result-object v4
 
-    invoke-static {v9, v0}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
-    :try_end_68
-    .catch Landroid/os/RemoteException; {:try_start_56 .. :try_end_68} :catch_69
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    goto :goto_32
+    move-result-object v6
 
-    :catch_69
-    move-exception v0
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    goto :goto_32
-.end method
+    move-result-object v4
 
-.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
-    .registers 25
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-object/from16 v3, p2
+    move-result-object v4
 
-    check-cast v3, Landroid/app/IApplicationThread;
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
+    :cond_6f
+    :goto_6f
     move-object/from16 v0, p0
 
     iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
 
-    if-eqz v2, :cond_49
+    if-eqz v2, :cond_28a
 
     move-object/from16 v0, p0
 
@@ -1036,19 +998,19 @@
 
     monitor-enter v4
 
-    :try_start_f
+    :try_start_7a
     move-object/from16 v0, p0
 
     iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
 
     invoke-interface {v2}, Ljava/util/List;->size()I
 
-    move-result v13
+    move-result v8
 
     const/4 v15, 0x0
 
-    :goto_18
-    if-ge v15, v13, :cond_48
+    :goto_83
+    if-ge v15, v8, :cond_289
 
     move-object/from16 v0, p0
 
@@ -1056,319 +1018,1916 @@
 
     invoke-interface {v2, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v14
+    move-result-object v10
 
-    check-cast v14, Landroid/app/Instrumentation$ActivityMonitor;
+    check-cast v10, Landroid/app/Instrumentation$ActivityMonitor;
 
     const/4 v2, 0x0
 
-    move-object/from16 v0, p1
+    const/4 v6, 0x0
 
-    move-object/from16 v1, p5
+    aget-object v6, p5, v6
+
+    move-object/from16 v0, p1
 
-    invoke-virtual {v14, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+    invoke-virtual {v10, v0, v2, v6}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
 
     move-result v2
 
-    if-eqz v2, :cond_45
+    if-eqz v2, :cond_285
 
-    iget v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    iget v2, v10, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
 
     add-int/lit8 v2, v2, 0x1
 
-    iput v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    iput v2, v10, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
 
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+    invoke-virtual {v10}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
 
     move-result v2
 
-    if-eqz v2, :cond_48
+    if-eqz v2, :cond_289
 
-    if-ltz p6, :cond_43
+    monitor-exit v4
+    :try_end_a8
+    .catchall {:try_start_7a .. :try_end_a8} :catchall_2aa
 
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+    :goto_a8
+    return-void
 
-    move-result-object v2
+    :catch_a9
+    move-exception v13
 
-    :goto_41
-    monitor-exit v4
+    const-string v2, "Instrumentation"
 
-    :goto_42
-    return-object v2
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    :cond_43
-    const/4 v2, 0x0
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    goto :goto_41
+    const-string v6, "PDroid:Instrumentation:execStartActivities: Exception occurred when checking intents for "
 
-    :cond_45
-    add-int/lit8 v15, v15, 0x1
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    goto :goto_18
+    move-result-object v4
 
-    :cond_48
-    monitor-exit v4
-    :try_end_49
-    .catchall {:try_start_f .. :try_end_49} :catchall_7e
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    :cond_49
-    const/4 v2, 0x0
+    move-result-object v6
 
-    :try_start_4a
-    move-object/from16 v0, p5
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+    move-result-object v4
 
-    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+    move-result-object v4
 
-    move-result-object v2
+    invoke-static {v2, v4, v13}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    const/4 v12, 0x1
 
-    move-result-object v4
+    :cond_c7
+    add-int/lit8 v16, v16, 0x1
 
-    move-object/from16 v0, p5
+    goto/16 :goto_2a
 
-    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+    :cond_cb
+    const-string v2, "Instrumentation"
 
-    move-result-object v5
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    if-eqz p4, :cond_81
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    move-object/from16 v0, p4
+    const-string v6, "PDroid:Instrumentation:execStartActivities: One or more intents triggered checking for "
 
-    iget-object v7, v0, Landroid/app/Activity;->mEmbeddedID:Ljava/lang/String;
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    :goto_66
-    const/4 v9, 0x0
+    move-result-object v4
 
-    const/4 v10, 0x0
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    const/4 v11, 0x0
+    move-result-object v6
 
-    move-object/from16 v4, p5
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-object/from16 v6, p3
+    move-result-object v4
 
-    move/from16 v8, p6
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-object/from16 v12, p7
+    move-result-object v4
 
-    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-result v16
+    move-object/from16 v0, p0
 
-    move/from16 v0, v16
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    move-object/from16 v1, p5
+    if-eqz v2, :cond_f7
 
-    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
-    :try_end_7c
-    .catch Landroid/os/RemoteException; {:try_start_4a .. :try_end_7c} :catch_83
+    move-object/from16 v0, p0
 
-    :goto_7c
-    const/4 v2, 0x0
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    goto :goto_42
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
 
-    :catchall_7e
-    move-exception v2
+    move-result v2
 
-    :try_start_7f
-    monitor-exit v4
-    :try_end_80
-    .catchall {:try_start_7f .. :try_end_80} :catchall_7e
+    if-nez v2, :cond_18d
 
-    throw v2
+    :cond_f7
+    new-instance v2, Landroid/privacy/PrivacySettingsManager;
 
-    :cond_81
-    const/4 v7, 0x0
+    const-string/jumbo v4, "privacy"
 
-    goto :goto_66
+    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    :catch_83
-    move-exception v2
+    move-result-object v4
 
-    goto :goto_7c
-.end method
+    invoke-static {v4}, Landroid/privacy/IPrivacySettingsManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/privacy/IPrivacySettingsManager;
 
-.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Fragment;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
-    .registers 25
+    move-result-object v4
 
-    move-object/from16 v3, p2
+    move-object/from16 v0, p1
 
-    check-cast v3, Landroid/app/IApplicationThread;
+    invoke-direct {v2, v0, v4}, Landroid/privacy/PrivacySettingsManager;-><init>(Landroid/content/Context;Landroid/privacy/IPrivacySettingsManager;)V
 
     move-object/from16 v0, p0
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    iput-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    if-eqz v2, :cond_49
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_185
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivities: Obtained privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_11a
+    const/4 v9, 0x0
 
     move-object/from16 v0, p0
 
-    iget-object v4, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    monitor-enter v4
+    if-eqz v2, :cond_12b
 
-    :try_start_f
     move-object/from16 v0, p0
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    invoke-interface {v2}, Ljava/util/List;->size()I
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
 
-    move-result v13
+    move-result v2
 
-    const/4 v15, 0x0
+    if-nez v2, :cond_195
+
+    :cond_12b
+    const-string v2, "Instrumentation"
 
-    :goto_18
-    if-ge v15, v13, :cond_48
+    const-string v4, "PDroid:Instrumentation:execStartActivities: Privacy service not available - assuming permission denied"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v9, 0x0
 
     move-object/from16 v0, p0
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    invoke-interface {v2, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    move-result-object v14
+    move-result-object v4
 
-    check-cast v14, Landroid/app/Instrumentation$ActivityMonitor;
+    const/4 v6, 0x1
 
-    const/4 v2, 0x0
+    const-string/jumbo v7, "phoneCall"
 
-    move-object/from16 v0, p1
+    const/16 v22, 0x0
 
-    move-object/from16 v1, p5
+    move-object/from16 v0, v22
+
+    invoke-virtual {v2, v4, v6, v7, v0}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    :goto_146
+    if-nez v9, :cond_6f
+
+    new-instance v14, Ljava/util/ArrayList;
+
+    move-object/from16 v0, p5
+
+    array-length v2, v0
+
+    invoke-direct {v14, v2}, Ljava/util/ArrayList;-><init>(I)V
+
+    move-object/from16 v11, p5
+
+    array-length v0, v11
+
+    move/from16 v18, v0
+
+    const/16 v16, 0x0
+
+    :goto_157
+    move/from16 v0, v16
+
+    move/from16 v1, v18
+
+    if-ge v0, v1, :cond_264
+
+    aget-object v17, v11, v16
+
+    :try_start_15f
+    invoke-virtual/range {v17 .. v17}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    if-eqz v2, :cond_17d
+
+    invoke-virtual/range {v17 .. v17}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
 
-    invoke-virtual {v14, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+    const-string v4, "android.intent.action.CALL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v2
 
-    if-eqz v2, :cond_45
+    if-nez v2, :cond_182
 
-    iget v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    invoke-virtual/range {v17 .. v17}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    add-int/lit8 v2, v2, 0x1
+    move-result-object v2
 
-    iput v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    const-string v4, "android.intent.action.DIAL"
 
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
     move-result v2
 
-    if-eqz v2, :cond_48
+    if-nez v2, :cond_182
 
-    if-ltz p6, :cond_43
+    :cond_17d
+    move-object/from16 v0, v17
 
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+    invoke-interface {v14, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z
+    :try_end_182
+    .catch Ljava/lang/Exception; {:try_start_15f .. :try_end_182} :catch_245
 
-    move-result-object v2
+    :cond_182
+    :goto_182
+    add-int/lit8 v16, v16, 0x1
 
-    :goto_41
-    monitor-exit v4
+    goto :goto_157
 
-    :goto_42
-    return-object v2
+    :cond_185
+    const-string v2, "Instrumentation"
 
-    :cond_43
-    const/4 v2, 0x0
+    const-string v4, "PDroid:Instrumentation:execStartActivities: Privacy service not obtained"
 
-    goto :goto_41
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_45
-    add-int/lit8 v15, v15, 0x1
+    goto :goto_11a
 
-    goto :goto_18
+    :cond_18d
+    const-string v2, "Instrumentation"
 
-    :cond_48
-    monitor-exit v4
-    :try_end_49
-    .catchall {:try_start_f .. :try_end_49} :catchall_7e
+    const-string v4, "PDroid:Instrumentation:execStartActivities: Already had privacy service"
 
-    :cond_49
-    const/4 v2, 0x0
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :try_start_4a
-    move-object/from16 v0, p5
+    goto :goto_11a
 
-    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+    :cond_195
+    move-object/from16 v0, p0
 
-    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    move-result-object v2
+    move-result-object v4
 
-    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {v2, v4}, Landroid/privacy/PrivacySettingsManager;->getSettings(Ljava/lang/String;)Landroid/privacy/PrivacySettings;
+
+    move-result-object v19
+
+    if-nez v19, :cond_1d5
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivities: Call intents allowed: No settings for package: "
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
     move-result-object v4
 
-    move-object/from16 v0, p5
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+    move-result-object v6
 
-    move-result-object v5
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    if-eqz p4, :cond_81
+    move-result-object v4
 
-    move-object/from16 v0, p4
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    iget-object v7, v0, Landroid/app/Fragment;->mWho:Ljava/lang/String;
+    move-result-object v4
 
-    :goto_66
-    const/4 v9, 0x0
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/4 v10, 0x0
+    const/4 v9, 0x1
 
-    const/4 v11, 0x0
+    move-object/from16 v0, p0
 
-    move-object/from16 v4, p5
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    move-object/from16 v6, p3
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    move/from16 v8, p6
+    move-result-object v4
 
-    move-object/from16 v12, p7
+    const/4 v6, 0x1
 
-    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+    const-string/jumbo v7, "phoneCall"
 
-    move-result v16
+    const/16 v22, 0x0
 
-    move/from16 v0, v16
+    move-object/from16 v0, v22
 
-    move-object/from16 v1, p5
+    invoke-virtual {v2, v4, v6, v7, v0}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
 
-    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
-    :try_end_7c
-    .catch Landroid/os/RemoteException; {:try_start_4a .. :try_end_7c} :catch_83
+    goto/16 :goto_146
 
-    :goto_7c
-    const/4 v2, 0x0
+    :cond_1d5
+    invoke-virtual/range {v19 .. v19}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
 
-    goto :goto_42
+    move-result v2
 
-    :catchall_7e
-    move-exception v2
+    if-nez v2, :cond_210
 
-    :try_start_7f
-    monitor-exit v4
-    :try_end_80
-    .catchall {:try_start_7f .. :try_end_80} :catchall_7e
+    const-string v2, "Instrumentation"
 
-    throw v2
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivities: Call intents allowed: Settings permit "
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v9, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v19 .. v19}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v6
+
+    const-string/jumbo v7, "phoneCall"
+
+    const/16 v22, 0x0
+
+    move-object/from16 v0, v22
+
+    invoke-virtual {v2, v4, v6, v7, v0}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_146
+
+    :cond_210
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivities: Call intents denied: Settings deny "
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v9, 0x0
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v19 .. v19}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v6
+
+    const-string/jumbo v7, "phoneCall"
+
+    const/16 v22, 0x0
+
+    move-object/from16 v0, v22
+
+    invoke-virtual {v2, v4, v6, v7, v0}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_146
+
+    :catch_245
+    move-exception v13
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivities: Exception occurred when checking intent for "
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4, v13}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto/16 :goto_182
+
+    :cond_264
+    invoke-interface {v14}, Ljava/util/List;->size()I
+
+    move-result v2
+
+    new-array v2, v2, [Landroid/content/Intent;
+
+    invoke-interface {v14, v2}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;
+
+    move-result-object p5
+
+    check-cast p5, [Landroid/content/Intent;
+
+    move-object/from16 v21, p1
+
+    new-instance v2, Ljava/lang/Thread;
+
+    new-instance v4, Landroid/app/Instrumentation$2;
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v21
+
+    invoke-direct {v4, v0, v1}, Landroid/app/Instrumentation$2;-><init>(Landroid/app/Instrumentation;Landroid/content/Context;)V
+
+    invoke-direct {v2, v4}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    invoke-virtual {v2}, Ljava/lang/Thread;->start()V
+
+    goto/16 :goto_6f
+
+    :cond_285
+    add-int/lit8 v15, v15, 0x1
+
+    goto/16 :goto_83
+
+    :cond_289
+    :try_start_289
+    monitor-exit v4
+    :try_end_28a
+    .catchall {:try_start_289 .. :try_end_28a} :catchall_2aa
+
+    :cond_28a
+    :try_start_28a
+    move-object/from16 v0, p5
+
+    array-length v2, v0
+
+    new-array v5, v2, [Ljava/lang/String;
+
+    const/4 v15, 0x0
+
+    :goto_290
+    move-object/from16 v0, p5
+
+    array-length v2, v0
+
+    if-ge v15, v2, :cond_2ad
+
+    aget-object v2, p5, v15
+
+    const/4 v4, 0x0
+
+    invoke-virtual {v2, v4}, Landroid/content/Intent;->setAllowFds(Z)V
+
+    aget-object v2, p5, v15
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v4
+
+    invoke-virtual {v2, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+
+    move-result-object v2
+
+    aput-object v2, v5, v15
+    :try_end_2a7
+    .catch Landroid/os/RemoteException; {:try_start_28a .. :try_end_2a7} :catch_2c5
+
+    add-int/lit8 v15, v15, 0x1
+
+    goto :goto_290
+
+    :catchall_2aa
+    move-exception v2
+
+    :try_start_2ab
+    monitor-exit v4
+    :try_end_2ac
+    .catchall {:try_start_2ab .. :try_end_2ac} :catchall_2aa
+
+    throw v2
+
+    :cond_2ad
+    :try_start_2ad
+    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+
+    move-result-object v2
+
+    move-object/from16 v4, p5
+
+    move-object/from16 v6, p3
+
+    move-object/from16 v7, p6
+
+    invoke-interface/range {v2 .. v7}, Landroid/app/IActivityManager;->startActivities(Landroid/app/IApplicationThread;[Landroid/content/Intent;[Ljava/lang/String;Landroid/os/IBinder;Landroid/os/Bundle;)I
+
+    move-result v20
+
+    const/4 v2, 0x0
+
+    aget-object v2, p5, v2
+
+    move/from16 v0, v20
+
+    invoke-static {v0, v2}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
+    :try_end_2c3
+    .catch Landroid/os/RemoteException; {:try_start_2ad .. :try_end_2c3} :catch_2c5
+
+    goto/16 :goto_a8
+
+    :catch_2c5
+    move-exception v2
+
+    goto/16 :goto_a8
+.end method
+
+.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
+    .registers 29
+
+    move-object/from16 v3, p2
+
+    check-cast v3, Landroid/app/IApplicationThread;
+
+    const/4 v14, 0x1
+
+    :try_start_5
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: execStartActivity for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    if-eqz v2, :cond_b7
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.CALL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-nez v2, :cond_3f
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.DIAL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_b7
+
+    :cond_3f
+    const/4 v14, 0x0
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Intent action = Intent.ACTION_CALL or Intent.ACTION_DIAL for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_6c
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_125
+
+    :cond_6c
+    new-instance v2, Landroid/privacy/PrivacySettingsManager;
+
+    const-string/jumbo v4, "privacy"
+
+    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+
+    move-result-object v4
+
+    invoke-static {v4}, Landroid/privacy/IPrivacySettingsManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/privacy/IPrivacySettingsManager;
+
+    move-result-object v4
+
+    move-object/from16 v0, p1
+
+    invoke-direct {v2, v0, v4}, Landroid/privacy/PrivacySettingsManager;-><init>(Landroid/content/Context;Landroid/privacy/IPrivacySettingsManager;)V
+
+    move-object/from16 v0, p0
+
+    iput-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_fb
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Obtained privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_8f
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_9f
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_12e
+
+    :cond_9f
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Privacy service not available: rejecting call attempt"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x0
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x1
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_b7
+    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_b7} :catch_103
+
+    :cond_b7
+    :goto_b7
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    if-eqz v2, :cond_1fb
+
+    move-object/from16 v0, p0
+
+    iget-object v4, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
+
+    monitor-enter v4
+
+    :try_start_c2
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    invoke-interface {v2}, Ljava/util/List;->size()I
+
+    move-result v13
+
+    const/16 v17, 0x0
+
+    :goto_cc
+    move/from16 v0, v17
+
+    if-ge v0, v13, :cond_1fa
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    move/from16 v0, v17
+
+    invoke-interface {v2, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
+
+    move-result-object v15
+
+    check-cast v15, Landroid/app/Instrumentation$ActivityMonitor;
+
+    const/4 v2, 0x0
+
+    move-object/from16 v0, p1
+
+    move-object/from16 v1, p5
+
+    invoke-virtual {v15, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1f6
+
+    iget v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    add-int/lit8 v2, v2, 0x1
+
+    iput v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1fa
+
+    if-ltz p6, :cond_1f3
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+
+    move-result-object v2
+
+    :goto_f9
+    monitor-exit v4
+    :try_end_fa
+    .catchall {:try_start_c2 .. :try_end_fa} :catchall_215
+
+    :goto_fa
+    return-object v2
+
+    :cond_fb
+    :try_start_fb
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Privacy service not obtained"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_102
+    .catch Ljava/lang/Exception; {:try_start_fb .. :try_end_102} :catch_103
+
+    goto :goto_8f
+
+    :catch_103
+    move-exception v16
+
+    if-eqz p1, :cond_1e8
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Exception occurred handling intent for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_b7
+
+    :cond_125
+    :try_start_125
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Already had privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_8f
+
+    :cond_12e
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v2, v4}, Landroid/privacy/PrivacySettingsManager;->getSettings(Ljava/lang/String;)Landroid/privacy/PrivacySettings;
+
+    move-result-object v18
+
+    if-nez v18, :cond_16b
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Call allowed: No settings for package: "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x0
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_16b
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v2
+
+    if-nez v2, :cond_1a3
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Call allowed: Settings permit "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_1a3
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Call denied: Settings deny "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x0
+
+    move-object/from16 v20, p1
+
+    new-instance v2, Ljava/lang/Thread;
+
+    new-instance v4, Landroid/app/Instrumentation$1;
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v20
+
+    invoke-direct {v4, v0, v1}, Landroid/app/Instrumentation$1;-><init>(Landroid/app/Instrumentation;Landroid/content/Context;)V
+
+    invoke-direct {v2, v4}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    invoke-virtual {v2}, Ljava/lang/Thread;->start()V
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_1e6
+    .catch Ljava/lang/Exception; {:try_start_125 .. :try_end_1e6} :catch_103
+
+    goto/16 :goto_b7
+
+    :cond_1e8
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Exception occurred handling intent for unknown package"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto/16 :goto_b7
+
+    :cond_1f3
+    const/4 v2, 0x0
+
+    goto/16 :goto_f9
+
+    :cond_1f6
+    add-int/lit8 v17, v17, 0x1
+
+    goto/16 :goto_cc
+
+    :cond_1fa
+    :try_start_1fa
+    monitor-exit v4
+    :try_end_1fb
+    .catchall {:try_start_1fa .. :try_end_1fb} :catchall_215
+
+    :cond_1fb
+    if-nez v14, :cond_218
+
+    :try_start_1fd
+    new-instance v2, Landroid/app/Instrumentation$ActivityResult;
+
+    move/from16 v0, p6
+
+    move-object/from16 v1, p5
+
+    invoke-direct {v2, v0, v1}, Landroid/app/Instrumentation$ActivityResult;-><init>(ILandroid/content/Intent;)V
+    :try_end_206
+    .catch Ljava/lang/Exception; {:try_start_1fd .. :try_end_206} :catch_208
+
+    goto/16 :goto_fa
+
+    :catch_208
+    move-exception v16
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Exception occurred while trying to create ActivityResult"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    const/4 v2, 0x0
+
+    goto/16 :goto_fa
+
+    :catchall_215
+    move-exception v2
+
+    :try_start_216
+    monitor-exit v4
+    :try_end_217
+    .catchall {:try_start_216 .. :try_end_217} :catchall_215
+
+    throw v2
+
+    :cond_218
+    const/4 v2, 0x0
+
+    :try_start_219
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+
+    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+
+    move-result-object v2
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v4
+
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+
+    move-result-object v5
+
+    if-eqz p4, :cond_24e
+
+    move-object/from16 v0, p4
+
+    iget-object v7, v0, Landroid/app/Activity;->mEmbeddedID:Ljava/lang/String;
+
+    :goto_235
+    const/4 v9, 0x0
+
+    const/4 v10, 0x0
+
+    const/4 v11, 0x0
+
+    move-object/from16 v4, p5
+
+    move-object/from16 v6, p3
+
+    move/from16 v8, p6
+
+    move-object/from16 v12, p7
+
+    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+
+    move-result v19
+
+    move/from16 v0, v19
+
+    move-object/from16 v1, p5
+
+    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
+    :try_end_24b
+    .catch Landroid/os/RemoteException; {:try_start_219 .. :try_end_24b} :catch_250
+
+    :goto_24b
+    const/4 v2, 0x0
+
+    goto/16 :goto_fa
+
+    :cond_24e
+    const/4 v7, 0x0
+
+    goto :goto_235
+
+    :catch_250
+    move-exception v2
+
+    goto :goto_24b
+.end method
+
+.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Fragment;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
+    .registers 29
+
+    move-object/from16 v3, p2
+
+    check-cast v3, Landroid/app/IApplicationThread;
+
+    const/4 v14, 0x1
+
+    :try_start_5
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): execStartActivity for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    if-eqz v2, :cond_b7
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.CALL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-nez v2, :cond_3f
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.DIAL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_b7
+
+    :cond_3f
+    const/4 v14, 0x0
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Intent action = Intent.ACTION_CALL or Intent.ACTION_DIAL for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_6c
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_125
+
+    :cond_6c
+    new-instance v2, Landroid/privacy/PrivacySettingsManager;
+
+    const-string/jumbo v4, "privacy"
+
+    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+
+    move-result-object v4
+
+    invoke-static {v4}, Landroid/privacy/IPrivacySettingsManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/privacy/IPrivacySettingsManager;
+
+    move-result-object v4
+
+    move-object/from16 v0, p1
+
+    invoke-direct {v2, v0, v4}, Landroid/privacy/PrivacySettingsManager;-><init>(Landroid/content/Context;Landroid/privacy/IPrivacySettingsManager;)V
+
+    move-object/from16 v0, p0
+
+    iput-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_fb
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Obtained privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_8f
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_9f
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_12e
+
+    :cond_9f
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Privacy service not available: rejecting call attempt"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x0
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x1
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_b7
+    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_b7} :catch_103
+
+    :cond_b7
+    :goto_b7
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    if-eqz v2, :cond_1fb
+
+    move-object/from16 v0, p0
+
+    iget-object v4, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
+
+    monitor-enter v4
+
+    :try_start_c2
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    invoke-interface {v2}, Ljava/util/List;->size()I
+
+    move-result v13
+
+    const/16 v17, 0x0
+
+    :goto_cc
+    move/from16 v0, v17
+
+    if-ge v0, v13, :cond_1fa
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    move/from16 v0, v17
+
+    invoke-interface {v2, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
+
+    move-result-object v15
+
+    check-cast v15, Landroid/app/Instrumentation$ActivityMonitor;
+
+    const/4 v2, 0x0
+
+    move-object/from16 v0, p1
+
+    move-object/from16 v1, p5
+
+    invoke-virtual {v15, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1f6
+
+    iget v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    add-int/lit8 v2, v2, 0x1
+
+    iput v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1fa
+
+    if-ltz p6, :cond_1f3
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+
+    move-result-object v2
+
+    :goto_f9
+    monitor-exit v4
+    :try_end_fa
+    .catchall {:try_start_c2 .. :try_end_fa} :catchall_215
+
+    :goto_fa
+    return-object v2
+
+    :cond_fb
+    :try_start_fb
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Privacy service not obtained"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_102
+    .catch Ljava/lang/Exception; {:try_start_fb .. :try_end_102} :catch_103
+
+    goto :goto_8f
+
+    :catch_103
+    move-exception v16
+
+    if-eqz p1, :cond_1e8
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Exception occurred handling intent for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_b7
+
+    :cond_125
+    :try_start_125
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Already had privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_8f
+
+    :cond_12e
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v2, v4}, Landroid/privacy/PrivacySettingsManager;->getSettings(Ljava/lang/String;)Landroid/privacy/PrivacySettings;
+
+    move-result-object v18
+
+    if-nez v18, :cond_16b
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Call allowed: No settings for package: "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x0
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_16b
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v2
+
+    if-nez v2, :cond_1a3
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Call allowed: Settings permit "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_1a3
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Call denied: Settings deny "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v20, p1
+
+    const/4 v14, 0x0
+
+    new-instance v2, Ljava/lang/Thread;
+
+    new-instance v4, Landroid/app/Instrumentation$3;
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v20
+
+    invoke-direct {v4, v0, v1}, Landroid/app/Instrumentation$3;-><init>(Landroid/app/Instrumentation;Landroid/content/Context;)V
+
+    invoke-direct {v2, v4}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    invoke-virtual {v2}, Ljava/lang/Thread;->start()V
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_1e6
+    .catch Ljava/lang/Exception; {:try_start_125 .. :try_end_1e6} :catch_103
+
+    goto/16 :goto_b7
+
+    :cond_1e8
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Exception occurred handling intent for unknown package"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto/16 :goto_b7
+
+    :cond_1f3
+    const/4 v2, 0x0
+
+    goto/16 :goto_f9
+
+    :cond_1f6
+    add-int/lit8 v17, v17, 0x1
+
+    goto/16 :goto_cc
+
+    :cond_1fa
+    :try_start_1fa
+    monitor-exit v4
+    :try_end_1fb
+    .catchall {:try_start_1fa .. :try_end_1fb} :catchall_215
+
+    :cond_1fb
+    if-nez v14, :cond_218
+
+    :try_start_1fd
+    new-instance v2, Landroid/app/Instrumentation$ActivityResult;
+
+    move/from16 v0, p6
+
+    move-object/from16 v1, p5
+
+    invoke-direct {v2, v0, v1}, Landroid/app/Instrumentation$ActivityResult;-><init>(ILandroid/content/Intent;)V
+    :try_end_206
+    .catch Ljava/lang/Exception; {:try_start_1fd .. :try_end_206} :catch_208
+
+    goto/16 :goto_fa
+
+    :catch_208
+    move-exception v16
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Exception occurred while trying to create ActivityResult"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    const/4 v2, 0x0
+
+    goto/16 :goto_fa
+
+    :catchall_215
+    move-exception v2
+
+    :try_start_216
+    monitor-exit v4
+    :try_end_217
+    .catchall {:try_start_216 .. :try_end_217} :catchall_215
+
+    throw v2
+
+    :cond_218
+    const/4 v2, 0x0
+
+    :try_start_219
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+
+    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+
+    move-result-object v2
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v4
+
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+
+    move-result-object v5
+
+    if-eqz p4, :cond_24e
+
+    move-object/from16 v0, p4
+
+    iget-object v7, v0, Landroid/app/Fragment;->mWho:Ljava/lang/String;
+
+    :goto_235
+    const/4 v9, 0x0
+
+    const/4 v10, 0x0
+
+    const/4 v11, 0x0
+
+    move-object/from16 v4, p5
+
+    move-object/from16 v6, p3
+
+    move/from16 v8, p6
+
+    move-object/from16 v12, p7
+
+    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+
+    move-result v19
+
+    move/from16 v0, v19
+
+    move-object/from16 v1, p5
+
+    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
+    :try_end_24b
+    .catch Landroid/os/RemoteException; {:try_start_219 .. :try_end_24b} :catch_250
+
+    :goto_24b
+    const/4 v2, 0x0
+
+    goto/16 :goto_fa
 
-    :cond_81
+    :cond_24e
     const/4 v7, 0x0
 
-    goto :goto_66
+    goto :goto_235
 
-    :catch_83
+    :catch_250
     move-exception v2
 
-    goto :goto_7c
+    goto :goto_24b
 .end method
 
 .method public finish(ILandroid/os/Bundle;)V
