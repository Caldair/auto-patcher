diff -Npru stock-framework/smali/android/app/Instrumentation.smali opd-framework/smali/android/app/Instrumentation.smali
--- stock-framework/smali/android/app/Instrumentation.smali	2013-02-11 12:08:03.732154640 -0600
+++ opd-framework/smali/android/app/Instrumentation.smali	2013-02-11 12:07:44.200057793 -0600
@@ -6,7 +6,6 @@
 # annotations
 .annotation system Ldalvik/annotation/MemberClasses;
     value = {
-        Landroid/app/Instrumentation$1;,
         Landroid/app/Instrumentation$Idler;,
         Landroid/app/Instrumentation$ActivityGoing;,
         Landroid/app/Instrumentation$ActivityWaiter;,
@@ -53,6 +52,8 @@
 
 .field private mPerformanceCollector:Landroid/os/PerformanceCollector;
 
+.field private mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
 .field private mRunner:Ljava/lang/Thread;
 
 .field private final mSync:Ljava/lang/Object;
@@ -891,176 +892,131 @@
 .end method
 
 .method public execStartActivitiesAsUser(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;[Landroid/content/Intent;Landroid/os/Bundle;I)V
-    .registers 20
-
-    move-object v2, p2
-
-    check-cast v2, Landroid/app/IApplicationThread;
-
-    iget-object v1, p0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
-
-    if-eqz v1, :cond_37
-
-    iget-object v3, p0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
-
-    monitor-enter v3
-
-    :try_start_a
-    iget-object v1, p0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
-
-    invoke-interface {v1}, Ljava/util/List;->size()I
-
-    move-result v8
-
-    const/4 v10, 0x0
-
-    :goto_11
-    if-ge v10, v8, :cond_36
+    .registers 31
 
-    iget-object v1, p0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
-
-    invoke-interface {v1, v10}, Ljava/util/List;->get(I)Ljava/lang/Object;
-
-    move-result-object v9
-
-    check-cast v9, Landroid/app/Instrumentation$ActivityMonitor;
-
-    const/4 v1, 0x0
+    move-object/from16 v3, p2
 
-    const/4 v5, 0x0
+    check-cast v3, Landroid/app/IApplicationThread;
 
-    aget-object v5, p5, v5
+    const-string v2, "Instrumentation"
 
-    invoke-virtual {v9, p1, v1, v5}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    move-result v1
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    if-eqz v1, :cond_33
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: execStartActivitiesAsUser for "
 
-    iget v1, v9, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    add-int/lit8 v1, v1, 0x1
+    move-result-object v4
 
-    iput v1, v9, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    invoke-virtual {v9}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+    move-result-object v6
 
-    move-result v1
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    if-eqz v1, :cond_36
+    move-result-object v4
 
-    monitor-exit v3
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    :goto_32
-    return-void
+    move-result-object v4
 
-    :cond_33
-    add-int/lit8 v10, v10, 0x1
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_11
+    if-eqz p5, :cond_6f
 
-    :cond_36
-    monitor-exit v3
-    :try_end_37
-    .catchall {:try_start_a .. :try_end_37} :catchall_57
+    const/4 v13, 0x0
 
-    :cond_37
-    :try_start_37
-    move-object/from16 v0, p5
+    move-object/from16 v12, p5
 
-    array-length v1, v0
+    array-length v0, v12
 
-    new-array v4, v1, [Ljava/lang/String;
+    move/from16 v19, v0
 
-    const/4 v10, 0x0
+    const/16 v17, 0x0
 
-    :goto_3d
-    move-object/from16 v0, p5
+    :goto_2a
+    move/from16 v0, v17
 
-    array-length v1, v0
+    move/from16 v1, v19
 
-    if-ge v10, v1, :cond_5a
+    if-ge v0, v1, :cond_51
 
-    aget-object v1, p5, v10
+    aget-object v18, v12, v17
 
-    const/4 v3, 0x0
+    :try_start_32
+    invoke-virtual/range {v18 .. v18}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    invoke-virtual {v1, v3}, Landroid/content/Intent;->setAllowFds(Z)V
+    move-result-object v2
 
-    aget-object v1, p5, v10
+    if-eqz v2, :cond_cc
 
-    invoke-virtual {p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual/range {v18 .. v18}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    move-result-object v3
+    move-result-object v2
 
-    invoke-virtual {v1, v3}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+    const-string v4, "android.intent.action.CALL"
 
-    move-result-object v1
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    aput-object v1, v4, v10
-    :try_end_54
-    .catch Landroid/os/RemoteException; {:try_start_37 .. :try_end_54} :catch_70
+    move-result v2
 
-    add-int/lit8 v10, v10, 0x1
+    if-nez v2, :cond_50
 
-    goto :goto_3d
+    invoke-virtual/range {v18 .. v18}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    :catchall_57
-    move-exception v1
+    move-result-object v2
 
-    :try_start_58
-    monitor-exit v3
-    :try_end_59
-    .catchall {:try_start_58 .. :try_end_59} :catchall_57
+    const-string v4, "android.intent.action.DIAL"
 
-    throw v1
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+    :try_end_4d
+    .catch Ljava/lang/Exception; {:try_start_32 .. :try_end_4d} :catch_ae
 
-    :cond_5a
-    :try_start_5a
-    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+    move-result v2
 
-    move-result-object v1
+    if-eqz v2, :cond_cc
 
-    move-object/from16 v3, p5
+    :cond_50
+    const/4 v13, 0x1
 
-    move-object v5, p3
+    :cond_51
+    if-nez v13, :cond_d0
 
-    move-object/from16 v6, p6
+    const-string v2, "Instrumentation"
 
-    move/from16 v7, p7
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    invoke-interface/range {v1 .. v7}, Landroid/app/IActivityManager;->startActivities(Landroid/app/IApplicationThread;[Landroid/content/Intent;[Ljava/lang/String;Landroid/os/IBinder;Landroid/os/Bundle;I)I
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    move-result v11
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: No provided intents triggered checking for "
 
-    const/4 v1, 0x0
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    aget-object v1, p5, v1
+    move-result-object v4
 
-    invoke-static {v11, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
-    :try_end_6f
-    .catch Landroid/os/RemoteException; {:try_start_5a .. :try_end_6f} :catch_70
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    goto :goto_32
+    move-result-object v6
 
-    :catch_70
-    move-exception v1
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    goto :goto_32
-.end method
+    move-result-object v4
 
-.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
-    .registers 25
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-object/from16 v3, p2
+    move-result-object v4
 
-    check-cast v3, Landroid/app/IApplicationThread;
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
+    :cond_6f
+    :goto_6f
     move-object/from16 v0, p0
 
     iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
 
-    if-eqz v2, :cond_49
+    if-eqz v2, :cond_283
 
     move-object/from16 v0, p0
 
@@ -1068,524 +1024,2595 @@
 
     monitor-enter v4
 
-    :try_start_f
+    :try_start_7a
     move-object/from16 v0, p0
 
     iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
 
     invoke-interface {v2}, Ljava/util/List;->size()I
 
-    move-result v13
+    move-result v9
+
+    const/16 v16, 0x0
 
-    const/4 v15, 0x0
+    :goto_84
+    move/from16 v0, v16
 
-    :goto_18
-    if-ge v15, v13, :cond_48
+    if-ge v0, v9, :cond_282
 
     move-object/from16 v0, p0
 
     iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
 
-    invoke-interface {v2, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    move/from16 v0, v16
+
+    invoke-interface {v2, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v14
+    move-result-object v11
 
-    check-cast v14, Landroid/app/Instrumentation$ActivityMonitor;
+    check-cast v11, Landroid/app/Instrumentation$ActivityMonitor;
 
     const/4 v2, 0x0
 
-    move-object/from16 v0, p1
+    const/4 v6, 0x0
 
-    move-object/from16 v1, p5
+    aget-object v6, p5, v6
+
+    move-object/from16 v0, p1
 
-    invoke-virtual {v14, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+    invoke-virtual {v11, v0, v2, v6}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
 
     move-result v2
 
-    if-eqz v2, :cond_45
+    if-eqz v2, :cond_27e
 
-    iget v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    iget v2, v11, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
 
     add-int/lit8 v2, v2, 0x1
 
-    iput v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    iput v2, v11, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
 
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+    invoke-virtual {v11}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
 
     move-result v2
 
-    if-eqz v2, :cond_48
+    if-eqz v2, :cond_282
 
-    if-ltz p6, :cond_43
-
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
-
-    move-result-object v2
-
-    :goto_41
     monitor-exit v4
+    :try_end_ad
+    .catchall {:try_start_7a .. :try_end_ad} :catchall_2a6
 
-    :goto_42
-    return-object v2
+    :goto_ad
+    return-void
 
-    :cond_43
-    const/4 v2, 0x0
+    :catch_ae
+    move-exception v14
 
-    goto :goto_41
+    const-string v2, "Instrumentation"
 
-    :cond_45
-    add-int/lit8 v15, v15, 0x1
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    goto :goto_18
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    :cond_48
-    monitor-exit v4
-    :try_end_49
-    .catchall {:try_start_f .. :try_end_49} :catchall_7e
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: Exception occurred when checking intents for "
 
-    :cond_49
-    const/4 v2, 0x0
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    :try_start_4a
-    move-object/from16 v0, p5
+    move-result-object v4
 
-    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+    move-result-object v6
 
-    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v2
+    move-result-object v4
 
-    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
     move-result-object v4
 
-    move-object/from16 v0, p5
+    invoke-static {v2, v4, v14}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+    const/4 v13, 0x1
 
-    move-result-object v5
+    :cond_cc
+    add-int/lit8 v17, v17, 0x1
 
-    if-eqz p4, :cond_81
+    goto/16 :goto_2a
 
-    move-object/from16 v0, p4
+    :cond_d0
+    const-string v2, "Instrumentation"
 
-    iget-object v7, v0, Landroid/app/Activity;->mEmbeddedID:Ljava/lang/String;
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    :goto_66
-    const/4 v9, 0x0
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    const/4 v10, 0x0
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: One or more intents triggered checking for "
 
-    const/4 v11, 0x0
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-object/from16 v4, p5
+    move-result-object v4
 
-    move-object/from16 v6, p3
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    move/from16 v8, p6
+    move-result-object v6
 
-    move-object/from16 v12, p7
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+    move-result-object v4
 
-    move-result v16
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move/from16 v0, v16
+    move-result-object v4
 
-    move-object/from16 v1, p5
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
-    :try_end_7c
-    .catch Landroid/os/RemoteException; {:try_start_4a .. :try_end_7c} :catch_83
+    move-object/from16 v0, p0
 
-    :goto_7c
-    const/4 v2, 0x0
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    goto :goto_42
+    if-eqz v2, :cond_fc
 
-    :catchall_7e
-    move-exception v2
+    move-object/from16 v0, p0
 
-    :try_start_7f
-    monitor-exit v4
-    :try_end_80
-    .catchall {:try_start_7f .. :try_end_80} :catchall_7e
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    throw v2
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
 
-    :cond_81
-    const/4 v7, 0x0
+    move-result v2
 
-    goto :goto_66
+    if-nez v2, :cond_18f
 
-    :catch_83
-    move-exception v2
+    :cond_fc
+    new-instance v2, Landroid/privacy/PrivacySettingsManager;
 
-    goto :goto_7c
-.end method
+    const-string/jumbo v4, "privacy"
 
-.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;Landroid/content/Intent;ILandroid/os/Bundle;Landroid/os/UserHandle;)Landroid/app/Instrumentation$ActivityResult;
-    .registers 27
+    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
 
-    move-object/from16 v3, p2
+    move-result-object v4
 
-    check-cast v3, Landroid/app/IApplicationThread;
+    invoke-static {v4}, Landroid/privacy/IPrivacySettingsManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/privacy/IPrivacySettingsManager;
 
-    move-object/from16 v0, p0
+    move-result-object v4
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    move-object/from16 v0, p1
 
-    if-eqz v2, :cond_4e
+    invoke-direct {v2, v0, v4}, Landroid/privacy/PrivacySettingsManager;-><init>(Landroid/content/Context;Landroid/privacy/IPrivacySettingsManager;)V
 
     move-object/from16 v0, p0
 
-    iget-object v4, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
-
-    monitor-enter v4
+    iput-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    :try_start_f
     move-object/from16 v0, p0
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    invoke-interface {v2}, Ljava/util/List;->size()I
+    if-eqz v2, :cond_187
 
-    move-result v14
+    const-string v2, "Instrumentation"
 
-    const/16 v16, 0x0
+    const-string v4, "PDroid:Instrumentation:execStartActivitiesAsUser: Obtained privacy service"
 
-    :goto_19
-    move/from16 v0, v16
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-ge v0, v14, :cond_4d
+    :goto_11f
+    const/4 v10, 0x0
 
     move-object/from16 v0, p0
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    move/from16 v0, v16
+    if-eqz v2, :cond_130
 
-    invoke-interface {v2, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    move-object/from16 v0, p0
 
-    move-result-object v15
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    check-cast v15, Landroid/app/Instrumentation$ActivityMonitor;
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
 
-    const/4 v2, 0x0
+    move-result v2
 
-    move-object/from16 v0, p1
+    if-nez v2, :cond_197
 
-    move-object/from16 v1, p5
+    :cond_130
+    const-string v2, "Instrumentation"
 
-    invoke-virtual {v15, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+    const-string v4, "PDroid:Instrumentation:execStartActivitiesAsUser: Privacy service not available - assuming permission denied"
 
-    move-result v2
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    if-eqz v2, :cond_4a
+    const/4 v10, 0x0
 
-    iget v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    move-object/from16 v0, p0
 
-    add-int/lit8 v2, v2, 0x1
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    iput v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+    move-result-object v4
 
-    move-result v2
+    const/4 v6, 0x1
 
-    if-eqz v2, :cond_4d
+    const-string/jumbo v7, "phoneCall"
 
-    if-ltz p6, :cond_48
+    const/4 v8, 0x0
 
-    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+    invoke-virtual {v2, v4, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
 
-    move-result-object v2
+    :goto_148
+    if-nez v10, :cond_6f
 
-    :goto_46
-    monitor-exit v4
+    new-instance v15, Ljava/util/ArrayList;
 
-    :goto_47
-    return-object v2
+    move-object/from16 v0, p5
 
-    :cond_48
-    const/4 v2, 0x0
+    array-length v2, v0
 
-    goto :goto_46
+    invoke-direct {v15, v2}, Ljava/util/ArrayList;-><init>(I)V
 
-    :cond_4a
-    add-int/lit8 v16, v16, 0x1
+    move-object/from16 v12, p5
 
-    goto :goto_19
+    array-length v0, v12
 
-    :cond_4d
-    monitor-exit v4
-    :try_end_4e
-    .catchall {:try_start_f .. :try_end_4e} :catchall_87
+    move/from16 v19, v0
 
-    :cond_4e
-    const/4 v2, 0x0
+    const/16 v17, 0x0
 
-    :try_start_4f
-    move-object/from16 v0, p5
+    :goto_159
+    move/from16 v0, v17
 
-    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+    move/from16 v1, v19
 
-    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+    if-ge v0, v1, :cond_25d
 
-    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+    aget-object v18, v12, v17
+
+    :try_start_161
+    invoke-virtual/range {v18 .. v18}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
     move-result-object v2
 
-    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    if-eqz v2, :cond_17f
 
-    move-result-object v4
+    invoke-virtual/range {v18 .. v18}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    move-object/from16 v0, p5
+    move-result-object v2
 
-    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+    const-string v4, "android.intent.action.CALL"
 
-    move-result-object v5
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    if-eqz p4, :cond_8a
+    move-result v2
 
-    move-object/from16 v0, p4
+    if-nez v2, :cond_184
 
-    iget-object v7, v0, Landroid/app/Activity;->mEmbeddedID:Ljava/lang/String;
+    invoke-virtual/range {v18 .. v18}, Landroid/content/Intent;->getAction()Ljava/lang/String;
 
-    :goto_6b
-    const/4 v9, 0x0
+    move-result-object v2
 
-    const/4 v10, 0x0
+    const-string v4, "android.intent.action.DIAL"
 
-    const/4 v11, 0x0
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
 
-    invoke-virtual/range {p8 .. p8}, Landroid/os/UserHandle;->getIdentifier()I
+    move-result v2
 
-    move-result v13
+    if-nez v2, :cond_184
 
-    move-object/from16 v4, p5
+    :cond_17f
+    move-object/from16 v0, v18
 
-    move-object/from16 v6, p3
+    invoke-interface {v15, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z
+    :try_end_184
+    .catch Ljava/lang/Exception; {:try_start_161 .. :try_end_184} :catch_23e
 
-    move/from16 v8, p6
+    :cond_184
+    :goto_184
+    add-int/lit8 v17, v17, 0x1
 
-    move-object/from16 v12, p7
+    goto :goto_159
 
-    invoke-interface/range {v2 .. v13}, Landroid/app/IActivityManager;->startActivityAsUser(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;I)I
+    :cond_187
+    const-string v2, "Instrumentation"
 
-    move-result v17
+    const-string v4, "PDroid:Instrumentation:execStartActivitiesAsUser: Privacy service not obtained"
 
-    move/from16 v0, v17
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    move-object/from16 v1, p5
+    goto :goto_11f
 
-    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
-    :try_end_85
-    .catch Landroid/os/RemoteException; {:try_start_4f .. :try_end_85} :catch_8c
+    :cond_18f
+    const-string v2, "Instrumentation"
 
-    :goto_85
-    const/4 v2, 0x0
+    const-string v4, "PDroid:Instrumentation:execStartActivitiesAsUser: Already had privacy service"
 
-    goto :goto_47
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :catchall_87
-    move-exception v2
+    goto :goto_11f
 
-    :try_start_88
-    monitor-exit v4
-    :try_end_89
-    .catchall {:try_start_88 .. :try_end_89} :catchall_87
+    :cond_197
+    move-object/from16 v0, p0
 
-    throw v2
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    :cond_8a
-    const/4 v7, 0x0
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    goto :goto_6b
+    move-result-object v4
 
-    :catch_8c
-    move-exception v2
+    invoke-virtual {v2, v4}, Landroid/privacy/PrivacySettingsManager;->getSettings(Ljava/lang/String;)Landroid/privacy/PrivacySettings;
 
-    goto :goto_85
-.end method
+    move-result-object v20
 
-.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Fragment;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
-    .registers 25
+    if-nez v20, :cond_1d4
 
-    move-object/from16 v3, p2
+    const-string v2, "Instrumentation"
 
-    check-cast v3, Landroid/app/IApplicationThread;
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    move-object/from16 v0, p0
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: Call intents allowed: No settings for package: "
 
-    if-eqz v2, :cond_49
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-object/from16 v0, p0
+    move-result-object v4
 
-    iget-object v4, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    monitor-enter v4
+    move-result-object v6
 
-    :try_start_f
-    move-object/from16 v0, p0
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    move-result-object v4
 
-    invoke-interface {v2}, Ljava/util/List;->size()I
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move-result v13
+    move-result-object v4
 
-    const/4 v15, 0x0
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_18
-    if-ge v15, v13, :cond_48
+    const/4 v10, 0x1
 
     move-object/from16 v0, p0
 
-    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    invoke-interface {v2, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    move-result-object v14
+    move-result-object v4
 
-    check-cast v14, Landroid/app/Instrumentation$ActivityMonitor;
+    const/4 v6, 0x1
 
-    const/4 v2, 0x0
+    const-string/jumbo v7, "phoneCall"
 
-    move-object/from16 v0, p1
+    const/4 v8, 0x0
 
-    move-object/from16 v1, p5
+    invoke-virtual {v2, v4, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
 
-    invoke-virtual {v14, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+    goto/16 :goto_148
+
+    :cond_1d4
+    invoke-virtual/range {v20 .. v20}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
 
     move-result v2
 
-    if-eqz v2, :cond_45
+    if-nez v2, :cond_20c
 
-    iget v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    const-string v2, "Instrumentation"
 
-    add-int/lit8 v2, v2, 0x1
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    iput v2, v14, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: Call intents allowed: Settings permit "
 
-    move-result v2
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    if-eqz v2, :cond_48
+    move-result-object v4
 
-    if-ltz p6, :cond_43
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    invoke-virtual {v14}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+    move-result-object v6
 
-    move-result-object v2
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    :goto_41
-    monitor-exit v4
+    move-result-object v4
 
-    :goto_42
-    return-object v2
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    :cond_43
-    const/4 v2, 0x0
+    move-result-object v4
 
-    goto :goto_41
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    :cond_45
-    add-int/lit8 v15, v15, 0x1
+    const/4 v10, 0x1
 
-    goto :goto_18
+    move-object/from16 v0, p0
 
-    :cond_48
-    monitor-exit v4
-    :try_end_49
-    .catchall {:try_start_f .. :try_end_49} :catchall_7e
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    :cond_49
-    const/4 v2, 0x0
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    :try_start_4a
-    move-object/from16 v0, p5
+    move-result-object v4
 
-    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+    invoke-virtual/range {v20 .. v20}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
 
-    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+    move-result v6
 
-    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+    const-string/jumbo v7, "phoneCall"
 
-    move-result-object v2
+    const/4 v8, 0x0
 
-    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+    invoke-virtual {v2, v4, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
 
-    move-result-object v4
+    goto/16 :goto_148
 
-    move-object/from16 v0, p5
+    :cond_20c
+    const-string v2, "Instrumentation"
 
-    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+    new-instance v4, Ljava/lang/StringBuilder;
 
-    move-result-object v5
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
 
-    if-eqz p4, :cond_81
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: Call intents denied: Settings deny "
 
-    move-object/from16 v0, p4
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    iget-object v7, v0, Landroid/app/Fragment;->mWho:Ljava/lang/String;
+    move-result-object v4
 
-    :goto_66
-    const/4 v9, 0x0
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    const/4 v10, 0x0
+    move-result-object v6
 
-    const/4 v11, 0x0
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-object/from16 v4, p5
+    move-result-object v4
 
-    move-object/from16 v6, p3
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    move/from16 v8, p6
+    move-result-object v4
 
-    move-object/from16 v12, p7
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+    const/4 v10, 0x0
 
-    move-result v16
+    move-object/from16 v0, p0
 
-    move/from16 v0, v16
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
 
-    move-object/from16 v1, p5
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
 
-    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
-    :try_end_7c
-    .catch Landroid/os/RemoteException; {:try_start_4a .. :try_end_7c} :catch_83
+    move-result-object v4
+
+    invoke-virtual/range {v20 .. v20}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v6
+
+    const-string/jumbo v7, "phoneCall"
+
+    const/4 v8, 0x0
+
+    invoke-virtual {v2, v4, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_148
+
+    :catch_23e
+    move-exception v14
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivitiesAsUser: Exception occurred when checking intent for "
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4, v14}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto/16 :goto_184
+
+    :cond_25d
+    invoke-interface {v15}, Ljava/util/List;->size()I
+
+    move-result v2
+
+    new-array v2, v2, [Landroid/content/Intent;
+
+    invoke-interface {v15, v2}, Ljava/util/List;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;
+
+    move-result-object p5
+
+    check-cast p5, [Landroid/content/Intent;
+
+    move-object/from16 v22, p1
+
+    new-instance v2, Ljava/lang/Thread;
+
+    new-instance v4, Landroid/app/Instrumentation$2;
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v22
+
+    invoke-direct {v4, v0, v1}, Landroid/app/Instrumentation$2;-><init>(Landroid/app/Instrumentation;Landroid/content/Context;)V
+
+    invoke-direct {v2, v4}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    invoke-virtual {v2}, Ljava/lang/Thread;->start()V
+
+    goto/16 :goto_6f
+
+    :cond_27e
+    add-int/lit8 v16, v16, 0x1
+
+    goto/16 :goto_84
+
+    :cond_282
+    :try_start_282
+    monitor-exit v4
+    :try_end_283
+    .catchall {:try_start_282 .. :try_end_283} :catchall_2a6
+
+    :cond_283
+    :try_start_283
+    move-object/from16 v0, p5
+
+    array-length v2, v0
+
+    new-array v5, v2, [Ljava/lang/String;
+
+    const/16 v16, 0x0
+
+    :goto_28a
+    move-object/from16 v0, p5
+
+    array-length v2, v0
+
+    move/from16 v0, v16
+
+    if-ge v0, v2, :cond_2a9
+
+    aget-object v2, p5, v16
+
+    const/4 v4, 0x0
+
+    invoke-virtual {v2, v4}, Landroid/content/Intent;->setAllowFds(Z)V
+
+    aget-object v2, p5, v16
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v4
+
+    invoke-virtual {v2, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+
+    move-result-object v2
+
+    aput-object v2, v5, v16
+    :try_end_2a3
+    .catch Landroid/os/RemoteException; {:try_start_283 .. :try_end_2a3} :catch_2c3
+
+    add-int/lit8 v16, v16, 0x1
+
+    goto :goto_28a
+
+    :catchall_2a6
+    move-exception v2
+
+    :try_start_2a7
+    monitor-exit v4
+    :try_end_2a8
+    .catchall {:try_start_2a7 .. :try_end_2a8} :catchall_2a6
+
+    throw v2
+
+    :cond_2a9
+    :try_start_2a9
+    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+
+    move-result-object v2
+
+    move-object/from16 v4, p5
+
+    move-object/from16 v6, p3
+
+    move-object/from16 v7, p6
+
+    move/from16 v8, p7
+
+    invoke-interface/range {v2 .. v8}, Landroid/app/IActivityManager;->startActivities(Landroid/app/IApplicationThread;[Landroid/content/Intent;[Ljava/lang/String;Landroid/os/IBinder;Landroid/os/Bundle;I)I
+
+    move-result v21
+
+    const/4 v2, 0x0
+
+    aget-object v2, p5, v2
+
+    move/from16 v0, v21
+
+    invoke-static {v0, v2}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
+    :try_end_2c1
+    .catch Landroid/os/RemoteException; {:try_start_2a9 .. :try_end_2c1} :catch_2c3
+
+    goto/16 :goto_ad
+
+    :catch_2c3
+    move-exception v2
+
+    goto/16 :goto_ad
+.end method
+
+.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
+    .registers 29
+
+    move-object/from16 v3, p2
+
+    check-cast v3, Landroid/app/IApplicationThread;
+
+    const/4 v14, 0x1
+
+    :try_start_5
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: execStartActivity for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    if-eqz v2, :cond_b7
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.CALL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-nez v2, :cond_3f
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.DIAL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_b7
+
+    :cond_3f
+    const/4 v14, 0x0
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Intent action = Intent.ACTION_CALL or Intent.ACTION_DIAL for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_6c
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_125
+
+    :cond_6c
+    new-instance v2, Landroid/privacy/PrivacySettingsManager;
+
+    const-string/jumbo v4, "privacy"
+
+    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+
+    move-result-object v4
+
+    invoke-static {v4}, Landroid/privacy/IPrivacySettingsManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/privacy/IPrivacySettingsManager;
+
+    move-result-object v4
+
+    move-object/from16 v0, p1
+
+    invoke-direct {v2, v0, v4}, Landroid/privacy/PrivacySettingsManager;-><init>(Landroid/content/Context;Landroid/privacy/IPrivacySettingsManager;)V
+
+    move-object/from16 v0, p0
+
+    iput-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_fb
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Obtained privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_8f
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_9f
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_12e
+
+    :cond_9f
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Privacy service not available: rejecting call attempt"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x0
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x1
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_b7
+    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_b7} :catch_103
+
+    :cond_b7
+    :goto_b7
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    if-eqz v2, :cond_1fb
+
+    move-object/from16 v0, p0
+
+    iget-object v4, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
+
+    monitor-enter v4
+
+    :try_start_c2
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    invoke-interface {v2}, Ljava/util/List;->size()I
+
+    move-result v13
+
+    const/16 v17, 0x0
+
+    :goto_cc
+    move/from16 v0, v17
+
+    if-ge v0, v13, :cond_1fa
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    move/from16 v0, v17
+
+    invoke-interface {v2, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
+
+    move-result-object v15
+
+    check-cast v15, Landroid/app/Instrumentation$ActivityMonitor;
+
+    const/4 v2, 0x0
+
+    move-object/from16 v0, p1
+
+    move-object/from16 v1, p5
+
+    invoke-virtual {v15, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1f6
+
+    iget v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    add-int/lit8 v2, v2, 0x1
+
+    iput v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1fa
+
+    if-ltz p6, :cond_1f3
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+
+    move-result-object v2
+
+    :goto_f9
+    monitor-exit v4
+    :try_end_fa
+    .catchall {:try_start_c2 .. :try_end_fa} :catchall_215
+
+    :goto_fa
+    return-object v2
+
+    :cond_fb
+    :try_start_fb
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Privacy service not obtained"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_102
+    .catch Ljava/lang/Exception; {:try_start_fb .. :try_end_102} :catch_103
+
+    goto :goto_8f
+
+    :catch_103
+    move-exception v16
+
+    if-eqz p1, :cond_1e8
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Exception occurred handling intent for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_b7
+
+    :cond_125
+    :try_start_125
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Already had privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_8f
+
+    :cond_12e
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v2, v4}, Landroid/privacy/PrivacySettingsManager;->getSettings(Ljava/lang/String;)Landroid/privacy/PrivacySettings;
+
+    move-result-object v18
+
+    if-nez v18, :cond_16b
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Call allowed: No settings for package: "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x0
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_16b
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v2
+
+    if-nez v2, :cond_1a3
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Call allowed: Settings permit "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_1a3
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity: Call denied: Settings deny "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x0
+
+    move-object/from16 v20, p1
+
+    new-instance v2, Ljava/lang/Thread;
+
+    new-instance v4, Landroid/app/Instrumentation$1;
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v20
+
+    invoke-direct {v4, v0, v1}, Landroid/app/Instrumentation$1;-><init>(Landroid/app/Instrumentation;Landroid/content/Context;)V
+
+    invoke-direct {v2, v4}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    invoke-virtual {v2}, Ljava/lang/Thread;->start()V
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_1e6
+    .catch Ljava/lang/Exception; {:try_start_125 .. :try_end_1e6} :catch_103
+
+    goto/16 :goto_b7
+
+    :cond_1e8
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Exception occurred handling intent for unknown package"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto/16 :goto_b7
+
+    :cond_1f3
+    const/4 v2, 0x0
+
+    goto/16 :goto_f9
+
+    :cond_1f6
+    add-int/lit8 v17, v17, 0x1
+
+    goto/16 :goto_cc
+
+    :cond_1fa
+    :try_start_1fa
+    monitor-exit v4
+    :try_end_1fb
+    .catchall {:try_start_1fa .. :try_end_1fb} :catchall_215
+
+    :cond_1fb
+    if-nez v14, :cond_218
+
+    :try_start_1fd
+    new-instance v2, Landroid/app/Instrumentation$ActivityResult;
+
+    move/from16 v0, p6
+
+    move-object/from16 v1, p5
+
+    invoke-direct {v2, v0, v1}, Landroid/app/Instrumentation$ActivityResult;-><init>(ILandroid/content/Intent;)V
+    :try_end_206
+    .catch Ljava/lang/Exception; {:try_start_1fd .. :try_end_206} :catch_208
+
+    goto/16 :goto_fa
+
+    :catch_208
+    move-exception v16
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity: Exception occurred while trying to create ActivityResult"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    const/4 v2, 0x0
+
+    goto/16 :goto_fa
+
+    :catchall_215
+    move-exception v2
+
+    :try_start_216
+    monitor-exit v4
+    :try_end_217
+    .catchall {:try_start_216 .. :try_end_217} :catchall_215
+
+    throw v2
+
+    :cond_218
+    const/4 v2, 0x0
+
+    :try_start_219
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+
+    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+
+    move-result-object v2
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v4
+
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+
+    move-result-object v5
+
+    if-eqz p4, :cond_24e
+
+    move-object/from16 v0, p4
+
+    iget-object v7, v0, Landroid/app/Activity;->mEmbeddedID:Ljava/lang/String;
+
+    :goto_235
+    const/4 v9, 0x0
+
+    const/4 v10, 0x0
+
+    const/4 v11, 0x0
+
+    move-object/from16 v4, p5
+
+    move-object/from16 v6, p3
+
+    move/from16 v8, p6
+
+    move-object/from16 v12, p7
+
+    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+
+    move-result v19
+
+    move/from16 v0, v19
+
+    move-object/from16 v1, p5
+
+    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
+    :try_end_24b
+    .catch Landroid/os/RemoteException; {:try_start_219 .. :try_end_24b} :catch_250
+
+    :goto_24b
+    const/4 v2, 0x0
+
+    goto/16 :goto_fa
+
+    :cond_24e
+    const/4 v7, 0x0
+
+    goto :goto_235
+
+    :catch_250
+    move-exception v2
+
+    goto :goto_24b
+.end method
+
+.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Activity;Landroid/content/Intent;ILandroid/os/Bundle;Landroid/os/UserHandle;)Landroid/app/Instrumentation$ActivityResult;
+    .registers 32
+
+    move-object/from16 v4, p2
+
+    check-cast v4, Landroid/app/IApplicationThread;
+
+    const/16 v16, 0x1
+
+    :try_start_6
+    const-string v3, "Instrumentation"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivity (with UserHandle): execStartActivity for "
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    if-eqz v3, :cond_ba
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    const-string v5, "android.intent.action.CALL"
+
+    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v3
+
+    if-nez v3, :cond_40
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    const-string v5, "android.intent.action.DIAL"
+
+    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v3
+
+    if-eqz v3, :cond_ba
+
+    :cond_40
+    const/16 v16, 0x0
+
+    const-string v3, "Instrumentation"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivity (with UserHandle): Intent action = Intent.ACTION_CALL or Intent.ACTION_DIAL for "
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v3, :cond_6e
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v3}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v3
+
+    if-nez v3, :cond_12e
+
+    :cond_6e
+    new-instance v3, Landroid/privacy/PrivacySettingsManager;
+
+    const-string/jumbo v5, "privacy"
+
+    invoke-static {v5}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+
+    move-result-object v5
+
+    invoke-static {v5}, Landroid/privacy/IPrivacySettingsManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/privacy/IPrivacySettingsManager;
+
+    move-result-object v5
+
+    move-object/from16 v0, p1
+
+    invoke-direct {v3, v0, v5}, Landroid/privacy/PrivacySettingsManager;-><init>(Landroid/content/Context;Landroid/privacy/IPrivacySettingsManager;)V
+
+    move-object/from16 v0, p0
+
+    iput-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v3, :cond_104
+
+    const-string v3, "Instrumentation"
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with UserHandle): Obtained privacy service"
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_91
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v3, :cond_a1
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v3}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v3
+
+    if-nez v3, :cond_137
+
+    :cond_a1
+    const-string v3, "Instrumentation"
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with UserHandle): Privacy service not available: rejecting call attempt"
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/16 v16, 0x0
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    const/4 v6, 0x1
+
+    const-string/jumbo v7, "phoneCall"
+
+    const/4 v8, 0x0
+
+    invoke-virtual {v3, v5, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_ba
+    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_ba} :catch_10c
+
+    :cond_ba
+    :goto_ba
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    if-eqz v3, :cond_207
+
+    move-object/from16 v0, p0
+
+    iget-object v5, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
+
+    monitor-enter v5
+
+    :try_start_c5
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    invoke-interface {v3}, Ljava/util/List;->size()I
+
+    move-result v15
+
+    const/16 v19, 0x0
+
+    :goto_cf
+    move/from16 v0, v19
+
+    if-ge v0, v15, :cond_206
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    move/from16 v0, v19
+
+    invoke-interface {v3, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
+
+    move-result-object v17
+
+    check-cast v17, Landroid/app/Instrumentation$ActivityMonitor;
+
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v17
+
+    move-object/from16 v1, p1
+
+    move-object/from16 v2, p5
+
+    invoke-virtual {v0, v1, v3, v2}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+
+    move-result v3
+
+    if-eqz v3, :cond_202
+
+    move-object/from16 v0, v17
+
+    iget v3, v0, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    add-int/lit8 v3, v3, 0x1
+
+    move-object/from16 v0, v17
+
+    iput v3, v0, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    invoke-virtual/range {v17 .. v17}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+
+    move-result v3
+
+    if-eqz v3, :cond_206
+
+    if-ltz p6, :cond_1ff
+
+    invoke-virtual/range {v17 .. v17}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+
+    move-result-object v3
+
+    :goto_102
+    monitor-exit v5
+    :try_end_103
+    .catchall {:try_start_c5 .. :try_end_103} :catchall_221
+
+    :goto_103
+    return-object v3
+
+    :cond_104
+    :try_start_104
+    const-string v3, "Instrumentation"
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with UserHandle): Privacy service not obtained"
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_10b
+    .catch Ljava/lang/Exception; {:try_start_104 .. :try_end_10b} :catch_10c
+
+    goto :goto_91
+
+    :catch_10c
+    move-exception v18
+
+    if-eqz p1, :cond_1f4
+
+    const-string v3, "Instrumentation"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivity (with UserHandle): Exception occurred handling intent for "
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    move-object/from16 v0, v18
+
+    invoke-static {v3, v5, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_ba
+
+    :cond_12e
+    :try_start_12e
+    const-string v3, "Instrumentation"
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with UserHandle): Already had privacy service"
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_91
+
+    :cond_137
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v3, v5}, Landroid/privacy/PrivacySettingsManager;->getSettings(Ljava/lang/String;)Landroid/privacy/PrivacySettings;
+
+    move-result-object v20
+
+    if-nez v20, :cond_175
+
+    const-string v3, "Instrumentation"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivity (with UserHandle): Call allowed: No settings for package: "
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/16 v16, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    const/4 v6, 0x0
+
+    const-string/jumbo v7, "phoneCall"
+
+    const/4 v8, 0x0
+
+    invoke-virtual {v3, v5, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_ba
+
+    :cond_175
+    invoke-virtual/range {v20 .. v20}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v3
+
+    if-nez v3, :cond_1ae
+
+    const-string v3, "Instrumentation"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivity (with UserHandle): Call allowed: Settings permit "
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/16 v16, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual/range {v20 .. v20}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v6
+
+    const-string/jumbo v7, "phoneCall"
+
+    const/4 v8, 0x0
+
+    invoke-virtual {v3, v5, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_ba
+
+    :cond_1ae
+    const-string v3, "Instrumentation"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v6, "PDroid:Instrumentation:execStartActivity (with UserHandle): Call denied: Settings deny "
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-static {v3, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v22, p1
+
+    const/16 v16, 0x0
+
+    new-instance v3, Ljava/lang/Thread;
+
+    new-instance v5, Landroid/app/Instrumentation$4;
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v22
+
+    invoke-direct {v5, v0, v1}, Landroid/app/Instrumentation$4;-><init>(Landroid/app/Instrumentation;Landroid/content/Context;)V
+
+    invoke-direct {v3, v5}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    invoke-virtual {v3}, Ljava/lang/Thread;->start()V
+
+    move-object/from16 v0, p0
+
+    iget-object v3, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual/range {v20 .. v20}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v6
+
+    const-string/jumbo v7, "phoneCall"
+
+    const/4 v8, 0x0
+
+    invoke-virtual {v3, v5, v6, v7, v8}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_1f2
+    .catch Ljava/lang/Exception; {:try_start_12e .. :try_end_1f2} :catch_10c
+
+    goto/16 :goto_ba
+
+    :cond_1f4
+    const-string v3, "Instrumentation"
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with UserHandle): Exception occurred handling intent for unknown package"
+
+    move-object/from16 v0, v18
+
+    invoke-static {v3, v5, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto/16 :goto_ba
+
+    :cond_1ff
+    const/4 v3, 0x0
+
+    goto/16 :goto_102
+
+    :cond_202
+    add-int/lit8 v19, v19, 0x1
+
+    goto/16 :goto_cf
+
+    :cond_206
+    :try_start_206
+    monitor-exit v5
+    :try_end_207
+    .catchall {:try_start_206 .. :try_end_207} :catchall_221
+
+    :cond_207
+    if-nez v16, :cond_224
+
+    :try_start_209
+    new-instance v3, Landroid/app/Instrumentation$ActivityResult;
+
+    move/from16 v0, p6
+
+    move-object/from16 v1, p5
+
+    invoke-direct {v3, v0, v1}, Landroid/app/Instrumentation$ActivityResult;-><init>(ILandroid/content/Intent;)V
+    :try_end_212
+    .catch Ljava/lang/Exception; {:try_start_209 .. :try_end_212} :catch_214
+
+    goto/16 :goto_103
+
+    :catch_214
+    move-exception v18
+
+    const-string v3, "Instrumentation"
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with UserHandle): Exception occurred while trying to create ActivityResult"
+
+    move-object/from16 v0, v18
+
+    invoke-static {v3, v5, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    const/4 v3, 0x0
+
+    goto/16 :goto_103
+
+    :catchall_221
+    move-exception v3
+
+    :try_start_222
+    monitor-exit v5
+    :try_end_223
+    .catchall {:try_start_222 .. :try_end_223} :catchall_221
+
+    throw v3
+
+    :cond_224
+    const/4 v3, 0x0
+
+    :try_start_225
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v3}, Landroid/content/Intent;->setAllowFds(Z)V
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+
+    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+
+    move-result-object v3
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v5
+
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v5}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+
+    move-result-object v6
+
+    if-eqz p4, :cond_25e
+
+    move-object/from16 v0, p4
+
+    iget-object v8, v0, Landroid/app/Activity;->mEmbeddedID:Ljava/lang/String;
+
+    :goto_241
+    const/4 v10, 0x0
+
+    const/4 v11, 0x0
+
+    const/4 v12, 0x0
+
+    invoke-virtual/range {p8 .. p8}, Landroid/os/UserHandle;->getIdentifier()I
+
+    move-result v14
+
+    move-object/from16 v5, p5
+
+    move-object/from16 v7, p3
+
+    move/from16 v9, p6
+
+    move-object/from16 v13, p7
+
+    invoke-interface/range {v3 .. v14}, Landroid/app/IActivityManager;->startActivityAsUser(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;I)I
+
+    move-result v21
+
+    move/from16 v0, v21
+
+    move-object/from16 v1, p5
+
+    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
+    :try_end_25b
+    .catch Landroid/os/RemoteException; {:try_start_225 .. :try_end_25b} :catch_260
+
+    :goto_25b
+    const/4 v3, 0x0
+
+    goto/16 :goto_103
+
+    :cond_25e
+    const/4 v8, 0x0
+
+    goto :goto_241
+
+    :catch_260
+    move-exception v3
+
+    goto :goto_25b
+.end method
+
+.method public execStartActivity(Landroid/content/Context;Landroid/os/IBinder;Landroid/os/IBinder;Landroid/app/Fragment;Landroid/content/Intent;ILandroid/os/Bundle;)Landroid/app/Instrumentation$ActivityResult;
+    .registers 29
+
+    move-object/from16 v3, p2
+
+    check-cast v3, Landroid/app/IApplicationThread;
+
+    const/4 v14, 0x1
+
+    :try_start_5
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): execStartActivity for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    if-eqz v2, :cond_b7
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.CALL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-nez v2, :cond_3f
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v2
+
+    const-string v4, "android.intent.action.DIAL"
+
+    invoke-virtual {v2, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_b7
+
+    :cond_3f
+    const/4 v14, 0x0
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Intent action = Intent.ACTION_CALL or Intent.ACTION_DIAL for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_6c
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_125
+
+    :cond_6c
+    new-instance v2, Landroid/privacy/PrivacySettingsManager;
+
+    const-string/jumbo v4, "privacy"
+
+    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;
+
+    move-result-object v4
+
+    invoke-static {v4}, Landroid/privacy/IPrivacySettingsManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/privacy/IPrivacySettingsManager;
+
+    move-result-object v4
+
+    move-object/from16 v0, p1
+
+    invoke-direct {v2, v0, v4}, Landroid/privacy/PrivacySettingsManager;-><init>(Landroid/content/Context;Landroid/privacy/IPrivacySettingsManager;)V
+
+    move-object/from16 v0, p0
+
+    iput-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_fb
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Obtained privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    :goto_8f
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    if-eqz v2, :cond_9f
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual {v2}, Landroid/privacy/PrivacySettingsManager;->isServiceAvailable()Z
+
+    move-result v2
+
+    if-nez v2, :cond_12e
+
+    :cond_9f
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Privacy service not available: rejecting call attempt"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x0
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x1
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_b7
+    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_b7} :catch_103
+
+    :cond_b7
+    :goto_b7
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    if-eqz v2, :cond_1fb
+
+    move-object/from16 v0, p0
+
+    iget-object v4, v0, Landroid/app/Instrumentation;->mSync:Ljava/lang/Object;
+
+    monitor-enter v4
+
+    :try_start_c2
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    invoke-interface {v2}, Ljava/util/List;->size()I
+
+    move-result v13
+
+    const/16 v17, 0x0
+
+    :goto_cc
+    move/from16 v0, v17
+
+    if-ge v0, v13, :cond_1fa
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mActivityMonitors:Ljava/util/List;
+
+    move/from16 v0, v17
+
+    invoke-interface {v2, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
+
+    move-result-object v15
+
+    check-cast v15, Landroid/app/Instrumentation$ActivityMonitor;
+
+    const/4 v2, 0x0
+
+    move-object/from16 v0, p1
+
+    move-object/from16 v1, p5
+
+    invoke-virtual {v15, v0, v2, v1}, Landroid/app/Instrumentation$ActivityMonitor;->match(Landroid/content/Context;Landroid/app/Activity;Landroid/content/Intent;)Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1f6
+
+    iget v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    add-int/lit8 v2, v2, 0x1
+
+    iput v2, v15, Landroid/app/Instrumentation$ActivityMonitor;->mHits:I
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->isBlocking()Z
+
+    move-result v2
+
+    if-eqz v2, :cond_1fa
+
+    if-ltz p6, :cond_1f3
+
+    invoke-virtual {v15}, Landroid/app/Instrumentation$ActivityMonitor;->getResult()Landroid/app/Instrumentation$ActivityResult;
+
+    move-result-object v2
+
+    :goto_f9
+    monitor-exit v4
+    :try_end_fa
+    .catchall {:try_start_c2 .. :try_end_fa} :catchall_215
+
+    :goto_fa
+    return-object v2
+
+    :cond_fb
+    :try_start_fb
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Privacy service not obtained"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    :try_end_102
+    .catch Ljava/lang/Exception; {:try_start_fb .. :try_end_102} :catch_103
+
+    goto :goto_8f
+
+    :catch_103
+    move-exception v16
+
+    if-eqz p1, :cond_1e8
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Exception occurred handling intent for "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto :goto_b7
+
+    :cond_125
+    :try_start_125
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Already had privacy service"
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_8f
+
+    :cond_12e
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual {v2, v4}, Landroid/privacy/PrivacySettingsManager;->getSettings(Ljava/lang/String;)Landroid/privacy/PrivacySettings;
+
+    move-result-object v18
+
+    if-nez v18, :cond_16b
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Call allowed: No settings for package: "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    const/4 v5, 0x0
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_16b
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v2
+
+    if-nez v2, :cond_1a3
+
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Call allowed: Settings permit "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    const/4 v14, 0x1
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+
+    goto/16 :goto_b7
+
+    :cond_1a3
+    const-string v2, "Instrumentation"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V
+
+    const-string v5, "PDroid:Instrumentation:execStartActivity (with Fragments): Call denied: Settings deny "
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+
+    move-object/from16 v20, p1
+
+    const/4 v14, 0x0
+
+    new-instance v2, Ljava/lang/Thread;
+
+    new-instance v4, Landroid/app/Instrumentation$3;
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v20
+
+    invoke-direct {v4, v0, v1}, Landroid/app/Instrumentation$3;-><init>(Landroid/app/Instrumentation;Landroid/content/Context;)V
+
+    invoke-direct {v2, v4}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    invoke-virtual {v2}, Ljava/lang/Thread;->start()V
+
+    move-object/from16 v0, p0
+
+    iget-object v2, v0, Landroid/app/Instrumentation;->mPrvSvc:Landroid/privacy/PrivacySettingsManager;
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getPackageName()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-virtual/range {v18 .. v18}, Landroid/privacy/PrivacySettings;->getPhoneCallSetting()B
+
+    move-result v5
+
+    const-string/jumbo v6, "phoneCall"
+
+    const/4 v7, 0x0
+
+    invoke-virtual {v2, v4, v5, v6, v7}, Landroid/privacy/PrivacySettingsManager;->notification(Ljava/lang/String;BLjava/lang/String;Ljava/lang/String;)V
+    :try_end_1e6
+    .catch Ljava/lang/Exception; {:try_start_125 .. :try_end_1e6} :catch_103
+
+    goto/16 :goto_b7
+
+    :cond_1e8
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Exception occurred handling intent for unknown package"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
+
+    goto/16 :goto_b7
+
+    :cond_1f3
+    const/4 v2, 0x0
+
+    goto/16 :goto_f9
+
+    :cond_1f6
+    add-int/lit8 v17, v17, 0x1
+
+    goto/16 :goto_cc
+
+    :cond_1fa
+    :try_start_1fa
+    monitor-exit v4
+    :try_end_1fb
+    .catchall {:try_start_1fa .. :try_end_1fb} :catchall_215
+
+    :cond_1fb
+    if-nez v14, :cond_218
+
+    :try_start_1fd
+    new-instance v2, Landroid/app/Instrumentation$ActivityResult;
+
+    move/from16 v0, p6
+
+    move-object/from16 v1, p5
+
+    invoke-direct {v2, v0, v1}, Landroid/app/Instrumentation$ActivityResult;-><init>(ILandroid/content/Intent;)V
+    :try_end_206
+    .catch Ljava/lang/Exception; {:try_start_1fd .. :try_end_206} :catch_208
+
+    goto/16 :goto_fa
+
+    :catch_208
+    move-exception v16
+
+    const-string v2, "Instrumentation"
+
+    const-string v4, "PDroid:Instrumentation:execStartActivity (with Fragments): Exception occurred while trying to create ActivityResult"
+
+    move-object/from16 v0, v16
+
+    invoke-static {v2, v4, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :goto_7c
     const/4 v2, 0x0
 
-    goto :goto_42
+    goto/16 :goto_fa
 
-    :catchall_7e
+    :catchall_215
     move-exception v2
 
-    :try_start_7f
+    :try_start_216
     monitor-exit v4
-    :try_end_80
-    .catchall {:try_start_7f .. :try_end_80} :catchall_7e
+    :try_end_217
+    .catchall {:try_start_216 .. :try_end_217} :catchall_215
 
     throw v2
 
-    :cond_81
+    :cond_218
+    const/4 v2, 0x0
+
+    :try_start_219
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v2}, Landroid/content/Intent;->setAllowFds(Z)V
+
+    invoke-virtual/range {p5 .. p5}, Landroid/content/Intent;->migrateExtraStreamToClipData()Z
+
+    invoke-static {}, Landroid/app/ActivityManagerNative;->getDefault()Landroid/app/IActivityManager;
+
+    move-result-object v2
+
+    invoke-virtual/range {p1 .. p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v4
+
+    move-object/from16 v0, p5
+
+    invoke-virtual {v0, v4}, Landroid/content/Intent;->resolveTypeIfNeeded(Landroid/content/ContentResolver;)Ljava/lang/String;
+
+    move-result-object v5
+
+    if-eqz p4, :cond_24e
+
+    move-object/from16 v0, p4
+
+    iget-object v7, v0, Landroid/app/Fragment;->mWho:Ljava/lang/String;
+
+    :goto_235
+    const/4 v9, 0x0
+
+    const/4 v10, 0x0
+
+    const/4 v11, 0x0
+
+    move-object/from16 v4, p5
+
+    move-object/from16 v6, p3
+
+    move/from16 v8, p6
+
+    move-object/from16 v12, p7
+
+    invoke-interface/range {v2 .. v12}, Landroid/app/IActivityManager;->startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IILjava/lang/String;Landroid/os/ParcelFileDescriptor;Landroid/os/Bundle;)I
+
+    move-result v19
+
+    move/from16 v0, v19
+
+    move-object/from16 v1, p5
+
+    invoke-static {v0, v1}, Landroid/app/Instrumentation;->checkStartActivityResult(ILjava/lang/Object;)V
+    :try_end_24b
+    .catch Landroid/os/RemoteException; {:try_start_219 .. :try_end_24b} :catch_250
+
+    :goto_24b
+    const/4 v2, 0x0
+
+    goto/16 :goto_fa
+
+    :cond_24e
     const/4 v7, 0x0
 
-    goto :goto_66
+    goto :goto_235
 
-    :catch_83
+    :catch_250
     move-exception v2
 
-    goto :goto_7c
+    goto :goto_24b
 .end method
 
 .method public finish(ILandroid/os/Bundle;)V
